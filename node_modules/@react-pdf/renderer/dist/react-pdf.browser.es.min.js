import _classCallCheck from"babel-runtime/helpers/classCallCheck";import _possibleConstructorReturn from"babel-runtime/helpers/possibleConstructorReturn";import _inherits from"babel-runtime/helpers/inherits";import _objectWithoutProperties from"babel-runtime/helpers/objectWithoutProperties";import React,{Fragment}from"react";import warning from"fbjs/lib/warning";import _extends from"babel-runtime/helpers/extends";import _regeneratorRuntime from"babel-runtime/regenerator";import _Promise from"babel-runtime/core-js/promise";import _asyncToGenerator from"babel-runtime/helpers/asyncToGenerator";import BlobStream from"blob-stream";import _typeof from"babel-runtime/helpers/typeof";import _Object$keys from"babel-runtime/core-js/object/keys";import ReactFiberReconciler from"react-reconciler";import emptyObject from"fbjs/lib/emptyObject";import _createClass from"babel-runtime/helpers/createClass";import PDFDocument,{PDFFont}from"@react-pdf/pdfkit";import{Attachment,AttributedString,Container,LayoutEngine,Path,Rect}from"@react-pdf/textkit-core";import scriptItemizer from"@react-pdf/script-itemizer";import justificationEngine from"@textkit/justification-engine";import textDecorationEngine from"@textkit/text-decoration-engine";import lineFragmentGenerator from"@textkit/line-fragment-generator";import _getIterator from"babel-runtime/core-js/get-iterator";import createLinebreaker from"@textkit/linebreaker";import english from"hyphenation.en-us";import Hypher from"hypher";import isUrl from"is-url";import fontkit from"@react-pdf/fontkit";import fetch from"isomorphic-fetch";import _wrapPages from"page-wrapping";import _Array$from from"babel-runtime/core-js/array/from";import emojiRegex from"emoji-regex";import _JSON$stringify from"babel-runtime/core-js/json/stringify";import PNG from"@react-pdf/png-js";import _Object$assign from"babel-runtime/core-js/object/assign";import toPairsIn from"lodash.topairsin";import isFunction from"lodash.isfunction";import upperFirst from"lodash.upperfirst";import Yoga from"yoga-layout";import pick from"lodash.pick";import merge from"lodash.merge";import matchMedia from"media-engine";import createPDFRenderer from"@textkit/pdf-renderer";var inheritedProperties=["color","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","textDecoration","lineHeight","textAlign","visibility","wordSpacing"],flatStyles=function(t){return t.reduce(function(t,e){return _extends({},t,e)},{})},StandardFont=function(){function t(e){_classCallCheck(this,t),this.name=e,this.src=PDFFont.open(null,e),this.glyphs={}}return t.prototype.layout=function(t){var e=this,r=this.src.encode(t),n=r[0],i=r[1];return{positions:i,stringIndices:i.map(function(t,e){return e}),glyphs:n.map(function(t,r){var n=e.getGlyph(parseInt(t,16));return n.advanceWidth=i[r].advanceWidth,n})}},t.prototype.glyphForCodePoint=function(t){var e=this.getGlyph(t);return e.advanceWidth=400,e},t.prototype.getGlyph=function(t){return this.glyphs[t]||(this.glyphs[t]=this.src.font.characterToGlyph(t)),{id:t,_font:this.src,name:this.glyphs[t]}},t.prototype.hasGlyphForCodePoint=function(t){return".notdef"!==this.src.font.characterToGlyph(t)},_createClass(t,[{key:"ascent",get:function(){return this.src.ascender}},{key:"descent",get:function(){return this.src.descender}},{key:"lineGap",get:function(){return this.src.lineGap}},{key:"unitsPerEm",get:function(){return 1e3}}]),t}(),fontSubstitutionEngine=function(){return function(t){var e=t.Run;return function(){function t(){_classCallCheck(this,t),this.fallbackFontInstance=null}return t.prototype.getRuns=function(t,r){var n=[],i=null,o=0,a=0,s=r,u=Array.isArray(s),h=0;for(s=u?s:_getIterator(s);;){var l;if(u){if(h>=s.length)break;l=s[h++]}else{if((h=s.next()).done)break;l=h.value}var c=l,p=void 0;if(p="string"==typeof c.attributes.font?new StandardFont(c.attributes.font):c.attributes.font,0===t.length){n.push(new e(0,0,{font:p}));break}var d=t.slice(c.start,c.end),f=Array.isArray(d),g=0;for(d=f?d:_getIterator(d);;){var m;if(f){if(g>=d.length)break;m=d[g++]}else{if((g=d.next()).done)break;m=g.value}var y=m,b=y.codePointAt(),v=p;!p.hasGlyphForCodePoint(b)&&this.fallbackFont.hasGlyphForCodePoint(b)&&(v=this.fallbackFont),v!==i&&(i&&n.push(new e(o,a,{font:i})),i=v,o=a),a+=y.length}}return o<t.length&&n.push(new e(o,t.length,{font:i})),n},_createClass(t,[{key:"fallbackFont",get:function(){return this.fallbackFontInstance||(this.fallbackFontInstance=new StandardFont("Helvetica")),this.fallbackFontInstance}}]),t}()}},Node=function(){function t(e){_classCallCheck(this,t),this.prev=null,this.next=null,this.data=e}return t.prototype.toString=function(){return this.data.toString()},t}(),LinkedList=function(){function t(){_classCallCheck(this,t),this.head=null,this.tail=null,this.listSize=0}return t.prototype.isLinked=function(t){return!(t&&null===t.prev&&null===t.next&&this.tail!==t&&this.head!==t||this.isEmpty())},t.prototype.size=function(){return this.listSize},t.prototype.isEmpty=function(){return 0===this.listSize},t.prototype.first=function(){return this.head},t.prototype.last=function(){return this.last},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.toArray=function(){for(var t=this.head,e=[];null!==t;)e.push(t),t=t.next;return e},t.prototype.forEach=function(t){for(var e=this.head;null!==e;)t(e),e=e.next},t.prototype.contains=function(t){var e=this.head;if(!this.isLinked(t))return!1;for(;null!==e;){if(e===t)return!0;e=e.next}return!1},t.prototype.at=function(t){var e=this.head,r=0;if(t>=this.listLength||t<0)return null;for(;null!==e;){if(t===r)return e;e=e.next,r+=1}return null},t.prototype.insertAfter=function(t,e){return this.isLinked(t)?(e.prev=t,e.next=t.next,null===t.next?this.tail=e:t.next.prev=e,t.next=e,this.listSize+=1,this):this},t.prototype.insertBefore=function(t,e){return this.isLinked(t)?(e.prev=t.prev,e.next=t,null===t.prev?this.head=e:t.prev.next=e,t.prev=e,this.listSize+=1,this):this},t.prototype.push=function(t){return null===this.head?this.unshift(t):this.insertAfter(this.tail,t),this},t.prototype.unshift=function(t){return null===this.head?(this.head=t,this.tail=t,t.prev=null,t.next=null,this.listSize+=1):this.insertBefore(this.head,t),this},t.prototype.remove=function(t){return this.isLinked(t)?(null===t.prev?this.head=t.next:t.prev.next=t.next,null===t.next?this.tail=t.prev:t.next.prev=t.prev,this.listSize-=1,this):this},t.prototype.pop=function(){var t=this.tail;return this.tail.prev.next=null,this.tail=this.tail.prev,this.listSize-=1,t.prev=null,t.next=null,t},t.prototype.shift=function(){var t=this.head;return this.head.next.prev=null,this.head=this.head.next,this.listSize-=1,t.prev=null,t.next=null,t},t}();LinkedList.Node=Node;var linebreak=function t(e,r,n){var i={demerits:{line:n&&n.demerits&&n.demerits.line||10,flagged:n&&n.demerits&&n.demerits.flagged||100,fitness:n&&n.demerits&&n.demerits.fitness||3e3},tolerance:n&&n.tolerance||3},o=new LinkedList,a={width:0,stretch:0,shrink:0},s=r,u=[],h={data:{demerits:1/0}};function l(t,e,r,n,i,o,a){return{position:t,demerits:e,ratio:r,line:n,fitnessClass:i,totals:o||{width:0,stretch:0,shrink:0},previous:a}}function c(r,n,i,o){var u=a.width-i.totals.width,h=0,l=0,c=o<s.length?s[o-1]:s[s.length-1];return"penalty"===e[n].type&&(u+=e[n].width),u<c?(h=a.stretch-i.totals.stretch)>0?(c-u)/h:t.infinity:u>c?(l=a.shrink-i.totals.shrink)>0?(c-u)/l:t.infinity:0}function p(r){for(var n={width:a.width,stretch:a.stretch,shrink:a.shrink},i=r;i<e.length;i+=1)if("glue"===e[i].type)n.width+=e[i].width,n.stretch+=e[i].stretch,n.shrink+=e[i].shrink;else if("box"===e[i].type||"penalty"===e[i].type&&e[i].penalty===-t.infinity&&i>r)break;return n}function d(e,r,n){for(var a=o.first(),s=null,u=0,h=0,d=[],f=void 0,g=0,m=void 0,y=0,b=void 0,v=void 0,E=void 0;null!==a;){for(d=[{demerits:1/0},{demerits:1/0},{demerits:1/0},{demerits:1/0}];null!==a&&(s=a.next,g=a.data.line+1,((u=c(a.data.position,r,a.data,g))<-1||"penalty"===e.type&&e.penalty===-t.infinity)&&o.remove(a),u>=-1&&u<=i.tolerance&&(f=100*Math.pow(Math.abs(u),3),h="penalty"===e.type&&e.penalty>=0?Math.pow(i.demerits.line+f,2)+Math.pow(e.penalty,2):"penalty"===e.type&&e.penalty!==-t.infinity?Math.pow(i.demerits.line+f,2)-Math.pow(e.penalty,2):Math.pow(i.demerits.line+f,2),"penalty"===e.type&&"penalty"===n[a.data.position].type&&(h+=i.demerits.flagged*e.flagged*n[a.data.position].flagged),y=u<-.5?0:u<=.5?1:u<=1?2:3,Math.abs(y-a.data.fitnessClass)>1&&(h+=i.demerits.fitness),(h+=a.data.demerits)<d[y].demerits&&(d[y]={active:a,demerits:h,ratio:u})),!(null!==(a=s)&&a.data.line>=g)););for(m=p(r),b=0;b<d.length;b+=1)(v=d[b]).demerits<1/0&&(E=new LinkedList.Node(l(r,v.demerits,v.ratio,v.active.data.line+1,b,m,v.active)),null!==a?o.insertBefore(a,E):o.push(E))}}if(o.push(new LinkedList.Node(l(0,0,0,0,0,void 0,null))),e.forEach(function(e,r,n){"box"===e.type?a.width+=e.width:"glue"===e.type?(r>0&&"box"===n[r-1].type&&d(e,r,n),a.width+=e.width,a.stretch+=e.stretch,a.shrink+=e.shrink):"penalty"===e.type&&e.penalty!==t.infinity&&d(e,r,n)}),0!==o.size()){for(o.forEach(function(t){t.data.demerits<h.data.demerits&&(h=t)});null!==h;)u.push({position:h.data.position,ratio:h.data.ratio}),h=h.data.previous;return u.reverse()}return[]};linebreak.infinity=1e4,linebreak.glue=function(t,e,r){return{type:"glue",width:t,stretch:e,shrink:r}},linebreak.box=function(t,e){return{type:"box",width:t,value:e,hyphenated:arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},linebreak.penalty=function(t,e,r){return{type:"penalty",width:t,penalty:e,flagged:r}};var SOFT_HYPHEN_HEX="Â­",NO_BREAK_SPACE_DECIMAL=160,getWords=function(t){var e=[],r=t.start,n=0,i=t,o=Array.isArray(i),a=0;for(i=o?i:_getIterator(i);;){var s;if(o){if(a>=i.length)break;s=i[a++]}else{if((a=i.next()).done)break;s=a.value}var u=s.index;if(t.codePointAtGlyphIndex(u)!==NO_BREAK_SPACE_DECIMAL&&t.isWhiteSpace(u-r)){var h=t.slice(n,u-r);h.length>0&&e.push(h),n=u-r+1}}if(n<t.end){var l=t.slice(n,t.end-t.start);e.push(l)}return e},h=new Hypher(english),hyphenateString=function(t){return t.includes(SOFT_HYPHEN_HEX)?t.split(SOFT_HYPHEN_HEX):h.hyphenate(t)},hyphenateWord=function(t){var e=0;return hyphenateString(t.string).map(function(r){var n=t.slice(e,e+r.length);return e+=r.length,n})},hyphenate=function(t){return t.map(function(t){return hyphenateWord(t)})},formatter=function(t,e,r){var n=t(" "),i=t("-"),o=e&&"justify"!==e?600:100,a=3,s=6,u=9;return function(e){var h=[],l=getWords(e),c=n*a/s,p=n*a/u;return(r||hyphenate)(l,e).forEach(function(e,r,a){e.length>1?e.forEach(function(r,n,a){var s=n===e.length-1;h.push(linebreak.box(t(r),r,!s)),n!==a.length-1&&h.push(linebreak.penalty(i,o,1))}):h.push(linebreak.box(t(e[0]),e[0])),r===a.length-1?(h.push(linebreak.glue(0,linebreak.infinity,0)),h.push(linebreak.penalty(0,-linebreak.infinity,1))):h.push(linebreak.glue(n,c,p))}),h}},HYPHEN=45,TOLERANCE_LIMIT=40,lineBreaker=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).hyphenationCallback;return function(e){var r=new(createLinebreaker()(e));return function(){function e(t){_classCallCheck(this,e),this.tolerance=t||4}return e.prototype.suggestLineBreak=function(e,n,i){for(var o=this.tolerance,a=this.measureWidth(e),s=formatter(a,i.align,t)(e),u=[];0===u.length&&o<TOLERANCE_LIMIT;)u=linebreak(s,[n],{tolerance:o}),o+=2;if(0===u.length){var h=r.suggestLineBreak(e,n,i);if(h)return h;var l=e.glyphIndexAtOffset(n)-1;return e.insertGlyph(l,HYPHEN),{position:l+1}}if(!u[1])return{position:e.end};var c=this.findBreakNode(s,u[1].position),p=c.value.end-e.start;return c.hyphenated?(e.insertGlyph(p,HYPHEN),{position:p+1}):{position:p+(e.isWhiteSpace(p)?1:0)}},e.prototype.measureWidth=function(t){var e=t.glyphRuns[0].attributes,r=e.font,n=e.fontSize;return function(t){if("string"==typeof t){var e=n/r.unitsPerEm;return r.layout(t).positions[0].xAdvance*e}return t.advanceWidth}},e.prototype.findBreakNode=function(t,e){for(var r=e-1;!t[r].value;)r-=1;return t[r]},e}()}},shrinkWhitespaceFactor={before:-.5,after:-.5},LayoutEngine$1=function(t){function e(r){var n=r.hyphenationCallback;_classCallCheck(this,e);var i={scriptItemizer:scriptItemizer(),decorationEngine:textDecorationEngine(),lineFragmentGenerator:lineFragmentGenerator(),fontSubstitutionEngine:fontSubstitutionEngine(),lineBreaker:lineBreaker({hyphenationCallback:n}),justificationEngine:justificationEngine({shrinkWhitespaceFactor:shrinkWhitespaceFactor})};return _possibleConstructorReturn(this,t.call(this,i))}return _inherits(e,t),e}(LayoutEngine),standardFonts=["Courier","Courier-Bold","Courier-Oblique","Helvetica","Helvetica-Bold","Helvetica-Oblique","Times-Roman","Times-Bold","Times-Italic"],fetchFont=function(t){return fetch(t).then(function(t){return t.buffer?t.buffer():t.arrayBuffer()}).then(function(t){return Buffer.from(t)})},fonts={},emojiSource=void 0,hyphenationCallback=void 0,register=function(t,e){var r=e.family,n=_objectWithoutProperties(e,["family"]);fonts[r]=_extends({src:t,loaded:!1,loading:!1,data:null},n)},registerHyphenationCallback=function(t){hyphenationCallback=t},registerEmojiSource=function(t){var e=t.url,r=t.format;emojiSource={url:e,format:void 0===r?"png":r}},getRegisteredFonts=function(){return _Object$keys(fonts)},getFont=function(t){return fonts[t]},getEmojiSource=function(){return emojiSource},getHyphenationCallback=function(){return hyphenationCallback},load=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(e,r){var n,i;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=fonts[e])||n.data||n.loading){t.next=11;break}if(n.loading=!0,!isUrl(n.src)){t.next=10;break}return t.next=6,fetchFont(n.src);case 6:i=t.sent,n.data=fontkit.create(i),t.next=11;break;case 10:n.data=fontkit.openSync(n.src);case 11:if(n&&!n.loaded&&(n.loaded=!0,n.loading=!1,r.registerFont(e,n.data)),n||standardFonts.includes(e)){t.next=14;break}throw new Error("Font family not registered: "+e+". Please register it calling Font.register() method.");case 14:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}(),reset=function(){for(var t in fonts)fonts.hasOwnProperty(t)&&(fonts[t].loaded=!1)},clear=function(){fonts={}},Font={register:register,getEmojiSource:getEmojiSource,getRegisteredFonts:getRegisteredFonts,registerEmojiSource:registerEmojiSource,registerHyphenationCallback:registerHyphenationCallback,getHyphenationCallback:getHyphenationCallback,getFont:getFont,load:load,clear:clear,reset:reset},Root=function(){function t(){_classCallCheck(this,t),this.isDirty=!1,this.document=null,this.instance=null,this._layoutEngine=null}return t.prototype.appendChild=function(t){this.document=t},t.prototype.markDirty=function(){this.isDirty=!0},t.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.instance=new PDFDocument({autoFirstPage:!1}),t.next=3,this.document.render();case 3:this.isDirty=!1;case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(t,[{key:"name",get:function(){return"Root"}},{key:"layoutEngine",get:function(){if(!this._layoutEngine){var t=Font.getHyphenationCallback();this._layoutEngine=new LayoutEngine$1({hyphenationCallback:t})}return this._layoutEngine}}]),t}(),MARKERS=[65472,65473,65474,65475,65477,65478,65479,65480,65481,65482,65483,65484,65485,65486,65487],JPEG=function t(e){if(_classCallCheck(this,t),this.data=null,this.width=null,this.height=null,this.data=e,65496!==e.readUInt16BE(0))throw new Error("SOI not found in JPEG");for(var r=void 0,n=2;n<e.length&&(r=e.readUInt16BE(n),n+=2,!MARKERS.includes(r));)n+=e.readUInt16BE(n);if(!MARKERS.includes(r))throw new Error("Invalid JPEG.");n+=3,this.height=e.readUInt16BE(n),n+=2,this.width=e.readUInt16BE(n)},createCache=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).limit,e=void 0===t?100:t,r={},n=[];return{get:function(t){return r[t]},set:function(t,i){n.push(t),n.length>e&&delete r[n.shift()],r[t]=i},length:function(){return n.length}}},imagesCache=createCache({limit:30}),isValidFormat=function(t){var e=t.toLowerCase();return"jpg"===e||"jpeg"===e||"png"===e},isCompatibleBase64=function(t){return/data:image\/[a-zA-Z]*;base64,[^"]*/g.test(t)};function getImage(t,e){switch(e.toLowerCase()){case"jpg":case"jpeg":return new JPEG(t);case"png":return new PNG(t);default:return null}}var resolveBase64Image=function(t){var e=/data:image\/([a-zA-Z]*);base64,([^"]*)/g.exec(t),r=e[1],n=e[2];if(!isValidFormat(r))throw new Error("Base64 image invalid format: "+r);return new _Promise(function(t){return t(getImage(Buffer.from(n,"base64"),r))})},resolveLocalImage=function(t){if(t.data&&t.format)return new _Promise(function(e){return e(getImage(t.data,t.format))});throw new Error("Invalid data given for local file: "+_JSON$stringify(t))},resolveRemoteImage=function(t){return fetch(t).then(function(t){return t.buffer?t.buffer():t.arrayBuffer()}).then(function(t){return"Buffer"===t.constructor.name?t:Buffer.from(t)}).then(function(t){var e=137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]&&13===t[4]&&10===t[5]&&26===t[6]&&10===t[7],r=255===t[0]&&216===t[1]&&255===t[2],n="";if(e)n="png";else{if(!r)throw new Error("Not valid image extension");n="jpg"}return getImage(t,n)})},resolveImage=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&imagesCache.get(t))return imagesCache.get(t);var r=void 0;return r=isCompatibleBase64(t)?resolveBase64Image(t):"object"===(void 0===t?"undefined":_typeof(t))?resolveLocalImage(t):resolveRemoteImage(t),e&&imagesCache.set(t,r),r},emojis={},regex=emojiRegex(),reflect=function(t){return function(){return t.apply(void 0,arguments).then(function(t){return t},function(t){return t})}},fetchEmojiImage=reflect(resolveImage),getCodePoints=function(t){return _Array$from(t).map(function(t){return t.codePointAt(0).toString(16)}).join("-")},buildEmojiUrl=function(t){var e=Font.getEmojiSource(),r=e.url,n=e.format;return""+r+getCodePoints(t)+"."+n},fetchEmojis=function(t){var e=Font.getEmojiSource();if(!e||!e.url)return[];for(var r=[],n=void 0,i=function(){var t=n[0];if(!emojis[t]||emojis[t].loading){var e=buildEmojiUrl(t);emojis[t]={loading:!0},r.push(fetchEmojiImage(e).then(function(e){emojis[t].loading=!1,emojis[t].data=e.data}))}};n=regex.exec(t);)i();return r},embedEmojis=function(t){for(var e=[],r=0;r<t.length;r++){for(var n=t[r],i=void 0,o=0;i=regex.exec(n.string);){var a=i.index,s=i[0],u=n.attributes.fontSize,h=n.string.slice(o,a+i[0].length);emojis[s]&&emojis[s].data?e.push({string:h.replace(i,Attachment.CHARACTER),attributes:_extends({},n.attributes,{attachment:new Attachment(u,u,{yOffset:Math.floor(.1*u),image:emojis[s].data})})}):e.push({string:h.replace(i,String.fromCharCode(0)),attributes:n.attributes}),o=a+s.length}o<n.string.length&&e.push({string:n.string.slice(o),attributes:n.attributes})}return e},Document$2=function(){function t(e,r){_classCallCheck(this,t),this.root=e,this.props=r,this.children=[]}return t.prototype.appendChild=function(t){t.parent=this,this.children.push(t)},t.prototype.removeChild=function(t){var e=this.children.indexOf(t);t.parent=null,this.children.slice(e,1)},t.prototype.addMetaData=function(){var t=this.props,e=t.title,r=t.author,n=t.subject,i=t.keywords,o=t.creator,a=t.producer;e&&(this.root.instance.info.Title=e),r&&(this.root.instance.info.Author=r),n&&(this.root.instance.info.Subject=n),i&&(this.root.instance.info.Keywords=i),this.root.instance.info.Creator=o||"react-pdf",this.root.instance.info.Producer=a||"react-pdf"},t.prototype.loadFonts=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],r=this.children.slice(0);r.length>0;)(n=r.shift()).style&&n.style.fontFamily&&e.push(Font.load(n.style.fontFamily,this.root.instance)),n.children&&n.children.forEach(function(t){r.push(t)});return t.next=5,_Promise.all(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.loadEmojis=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],r=this.children.slice(0);r.length>0;)"string"==typeof(n=r.shift())?e.push.apply(e,fetchEmojis(n)):n.children&&n.children.forEach(function(t){r.push(t)});return t.next=5,_Promise.all(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.loadImages=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],r=this.children.slice(0);r.length>0;)"Image"===(n=r.shift()).name&&e.push(n.fetch()),n.children&&n.children.forEach(function(t){r.push(t)});return t.next=5,_Promise.all(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.loadAssets=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_Promise.all([this.loadFonts(),this.loadImages()]);case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.applyProps=function(){this.children.forEach(function(t){return t.applyProps()})},t.prototype.update=function(t){this.props=t},t.prototype.wrapPages=function(){var t=1;return this.children.reduce(function(e,r){var n=r.size.height-(r.style.paddingBottom||0);if(r.wrap){var i=_wrapPages(r,n,t);return t+=i.length,[].concat(e,i)}return r.height=r.size.height,[].concat(e,[r])},[])},t.prototype.renderPages=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.wrapPages(),r=0;case 2:if(!(r<e.length)){t.next=9;break}return e[r].renderDynamicNodes({pageNumber:r+1,totalPages:e.length},function(t){return"Text"===t.name}),t.next=6,e[r].render();case 6:r++,t.next=2;break;case 9:return t.abrupt("return",e);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),t.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.addMetaData(),this.applyProps(),t.next=5,this.loadEmojis();case 5:return t.next=7,this.loadAssets();case 7:return t.next=9,this.renderPages();case 9:this.root.instance.end(),Font.reset(),t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(0),t.t0;case 16:case"end":return t.stop()}},t,this,[[0,13]])}));return function(){return t.apply(this,arguments)}}(),_createClass(t,[{key:"name",get:function(){return"Document"}}]),t}();Document$2.defaultProps={author:null,keywords:null,subject:null,title:null};var PERCENT=/^(\d+)?%$/g,Node$1=function(){function t(){_classCallCheck(this,t),this.parent=null,this.children=[],this.computed=!1,this.layout=Yoga.Node.createDefault()}return t.prototype.appendChild=function(t){t&&(t.parent=this,this.children.push(t),this.layout.insertChild(t.layout,this.layout.getChildCount()))},t.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!==e&&(t.parent=null,this.children.splice(e,1),this.layout.removeChild(t.layout))},t.prototype.removeAllChilds=function(){for(var t=[].concat(this.children),e=0;e<t.length;e++)t[e].remove()},t.prototype.remove=function(){this.parent.removeChild(this)},t.prototype.setDimension=function(t,e){var r="set"+upperFirst(t),n=r+"Percent",i=PERCENT.exec(e);i?this.layout[n](parseInt(i[1],10)):this.layout[r](e)},t.prototype.setPosition=function(t,e){var r=PERCENT.exec(e);r?this.layout.setPositionPercent(t,parseInt(r[1],10)):this.layout.setPosition(t,e)},t.prototype.setPadding=function(t,e){var r=PERCENT.exec(e);r?this.layout.setPaddingPercent(t,parseInt(r[1],10)):this.layout.setPadding(t,e)},t.prototype.setMargin=function(t,e){var r=PERCENT.exec(e);r?this.layout.setMarginPercent(t,parseInt(r[1],10)):this.layout.setMargin(t,e)},t.prototype.setBorder=function(t,e){if(PERCENT.exec(e))throw new Error("Node: You cannot set percentage border widths");this.layout.setBorder(t,e)},t.prototype.getAbsoluteLayout=function(){var t=this.parent,e=t&&t.getAbsoluteLayout?t.getAbsoluteLayout():{left:0,top:0};return{left:this.left+e.left,top:this.top+e.top,height:this.height,width:this.width}},t.prototype.copyStyle=function(t){this.layout.copyStyle(t.layout)},t.prototype.calculateLayout=function(){this.layout.calculateLayout(),this.computed=!0},t.prototype.isEmpty=function(){return 0===this.children.length},t.prototype.markDirty=function(){return this.layout.markDirty()},_createClass(t,[{key:"position",get:function(){return this.layout.getPositionType()===Yoga.POSITION_TYPE_ABSOLUTE?"absolute":"relative"},set:function(t){this.layout.setPositionType("absolute"===t?Yoga.POSITION_TYPE_ABSOLUTE:Yoga.POSITION_TYPE_RELATIVE)}},{key:"top",get:function(){return this.layout.getComputedTop()||0},set:function(t){this.setPosition(Yoga.EDGE_TOP,t)}},{key:"left",get:function(){return this.layout.getComputedLeft()||0},set:function(t){this.setPosition(Yoga.EDGE_LEFT,t)}},{key:"right",get:function(){return this.layout.getComputedRight()||0},set:function(t){this.setPosition(Yoga.EDGE_RIGHT,t)}},{key:"bottom",get:function(){return this.layout.getComputedBottom()||0},set:function(t){this.setPosition(Yoga.EDGE_BOTTOM,t)}},{key:"width",get:function(){return this.layout.getComputedWidth()},set:function(t){this.setDimension("width",t)}},{key:"minWidth",get:function(){return this.layout.getMinWidth().value},set:function(t){this.setDimension("minWidth",t)}},{key:"maxWidth",get:function(){return this.layout.getMaxWidth().value},set:function(t){this.setDimension("maxWidth",t)}},{key:"height",get:function(){return this.layout.getComputedHeight()},set:function(t){this.setDimension("height",t)}},{key:"minHeight",get:function(){return this.layout.getMinHeight().value},set:function(t){this.setDimension("minHeight",t)}},{key:"maxHeight",get:function(){return this.layout.getMaxHeight().value},set:function(t){this.setDimension("maxHeight",t)}},{key:"paddingTop",get:function(){return this.layout.getComputedPadding(Yoga.EDGE_TOP)||0},set:function(t){this.setPadding(Yoga.EDGE_TOP,t)}},{key:"paddingRight",get:function(){return this.layout.getComputedPadding(Yoga.EDGE_RIGHT)||0},set:function(t){this.setPadding(Yoga.EDGE_RIGHT,t)}},{key:"paddingBottom",get:function(){return this.layout.getComputedPadding(Yoga.EDGE_BOTTOM)||0},set:function(t){this.setPadding(Yoga.EDGE_BOTTOM,t)}},{key:"paddingLeft",get:function(){return this.layout.getComputedPadding(Yoga.EDGE_LEFT)||0},set:function(t){this.setPadding(Yoga.EDGE_LEFT,t)}},{key:"marginTop",get:function(){return this.layout.getComputedMargin(Yoga.EDGE_TOP)||0},set:function(t){this.setMargin(Yoga.EDGE_TOP,t)}},{key:"marginRight",get:function(){return this.layout.getComputedMargin(Yoga.EDGE_RIGHT)||0},set:function(t){this.setMargin(Yoga.EDGE_RIGHT,t)}},{key:"marginBottom",get:function(){return this.layout.getComputedMargin(Yoga.EDGE_BOTTOM)||0},set:function(t){this.setMargin(Yoga.EDGE_BOTTOM,t)}},{key:"marginLeft",get:function(){return this.layout.getComputedMargin(Yoga.EDGE_LEFT)||0},set:function(t){this.setMargin(Yoga.EDGE_LEFT,t)}},{key:"borderTopWidth",get:function(){return this.layout.getComputedBorder(Yoga.EDGE_TOP)||0},set:function(t){this.setBorder(Yoga.EDGE_TOP,t)}},{key:"borderRightWidth",get:function(){return this.layout.getComputedBorder(Yoga.EDGE_RIGHT)||0},set:function(t){this.setBorder(Yoga.EDGE_RIGHT,t)}},{key:"borderBottomWidth",get:function(){return this.layout.getComputedBorder(Yoga.EDGE_BOTTOM)||0},set:function(t){this.setBorder(Yoga.EDGE_BOTTOM,t)}},{key:"borderLeftWidth",get:function(){return this.layout.getComputedBorder(Yoga.EDGE_LEFT)||0},set:function(t){this.setBorder(Yoga.EDGE_LEFT,t)}},{key:"padding",get:function(){return{top:this.paddingTop,right:this.paddingRight,bottom:this.paddingBottom,left:this.paddingLeft}},set:function(t){this.paddingTop=t,this.paddingRight=t,this.paddingBottom=t,this.paddingLeft=t}},{key:"margin",get:function(){return{top:this.marginTop,right:this.marginRight,bottom:this.marginBottom,left:this.marginLeft}},set:function(t){this.marginTop=t,this.marginRight=t,this.marginBottom=t,this.marginLeft=t}}]),t}(),yogaValue=function(t,e){var r=function(t){return"alignItems"===t||"alignContent"===t||"alignSelf"===t};switch(e){case"auto":if("alignSelf"===t)return Yoga.ALIGN_AUTO;break;case"flex":return Yoga.DISPLAY_FLEX;case"none":return Yoga.DISPLAY_NONE;case"row":return Yoga.FLEX_DIRECTION_ROW;case"row-reverse":return Yoga.FLEX_DIRECTION_ROW_REVERSE;case"column":return Yoga.FLEX_DIRECTION_COLUMN;case"column-reverse":return Yoga.FLEX_DIRECTION_COLUMN_REVERSE;case"stretch":return Yoga.ALIGN_STRETCH;case"baseline":return Yoga.ALIGN_BASELINE;case"space-around":if("justifyContent"===t)return Yoga.JUSTIFY_SPACE_AROUND;if(r(t))return Yoga.ALIGN_SPACE_AROUND;break;case"space-between":if("justifyContent"===t)return Yoga.JUSTIFY_SPACE_BETWEEN;if(r(t))return Yoga.ALIGN_SPACE_BETWEEN;break;case"around":return Yoga.JUSTIFY_SPACE_AROUND;case"between":return Yoga.JUSTIFY_SPACE_BETWEEN;case"wrap":return Yoga.WRAP_WRAP;case"wrap-reverse":return Yoga.WRAP_WRAP_REVERSE;case"nowrap":return Yoga.WRAP_NO_WRAP;case"flex-start":if("justifyContent"===t)return Yoga.JUSTIFY_FLEX_START;if(r(t))return Yoga.ALIGN_FLEX_START;break;case"flex-end":if("justifyContent"===t)return Yoga.JUSTIFY_FLEX_END;if(r(t))return Yoga.ALIGN_FLEX_END;break;case"center":if("justifyContent"===t)return Yoga.JUSTIFY_CENTER;if(r(t))return Yoga.ALIGN_CENTER;break;default:return e}},parseValue=function(t){var e=/^(\d*\.?\d+)(in|mm|cm|pt)?$/g.exec(t);return e?{value:parseFloat(e[1],10),unit:e[2]||"pt"}:{value:t,unit:void 0}},parseScalar=function(t){var e={},r=parseValue(t);switch(r.unit){case"in":e=72*r.value;break;case"mm":e=r.value*(1/25.4)*72;break;case"cm":e=r.value*(1/2.54)*72;break;default:e=r.value}return e},hasOwnProperty=Object.prototype.hasOwnProperty,styleShortHands={margin:{marginTop:!0,marginRight:!0,marginBottom:!0,marginLeft:!0},marginHorizontal:{marginLeft:!0,marginRight:!0},marginVertical:{marginTop:!0,marginBottom:!0},padding:{paddingTop:!0,paddingRight:!0,paddingBottom:!0,paddingLeft:!0},paddingHorizontal:{paddingLeft:!0,paddingRight:!0},paddingVertical:{paddingTop:!0,paddingBottom:!0},border:{borderTopColor:!0,borderTopStyle:!0,borderTopWidth:!0,borderRightColor:!0,borderRightStyle:!0,borderRightWidth:!0,borderBottomColor:!0,borderBottomStyle:!0,borderBottomWidth:!0,borderLeftColor:!0,borderLeftStyle:!0,borderLeftWidth:!0},borderTop:{borderTopColor:!0,borderTopStyle:!0,borderTopWidth:!0},borderRight:{borderRightColor:!0,borderRightStyle:!0,borderRightWidth:!0},borderBottom:{borderBottomColor:!0,borderBottomStyle:!0,borderBottomWidth:!0},borderLeft:{borderLeftColor:!0,borderLeftStyle:!0,borderLeftWidth:!0},borderColor:{borderTopColor:!0,borderRightColor:!0,borderBottomColor:!0,borderLeftColor:!0},borderRadius:{borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0},borderStyle:{borderTopStyle:!0,borderRightStyle:!0,borderBottomStyle:!0,borderLeftStyle:!0},borderWidth:{borderTopWidth:!0,borderRightWidth:!0,borderBottomWidth:!0,borderLeftWidth:!0}},expandStyles=function(t){if(!t)return t;for(var e=_Object$keys(t),r={},n=0;n<e.length;n++){var i=e[n],o=t[i];switch(i){case"display":case"flex":case"flexDirection":case"flexWrap":case"flexFlow":case"flexGrow":case"flexShrink":case"flexBasis":case"justifyContent":case"alignSelf":case"alignItems":case"alignContent":case"order":r[i]=yogaValue(i,o);break;case"textAlignVertical":r.verticalAlign="center"===o?"middle":o;break;case"margin":case"marginHorizontal":case"marginVertical":case"padding":case"paddingHorizontal":case"paddingVertical":case"border":case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":case"borderColor":case"borderRadius":case"borderStyle":case"borderWidth":var a=styleShortHands[i];for(var s in a)hasOwnProperty.call(a,s)&&(r[s]=o);break;default:r[i]=o}}return r},matchBorderShorthand=function(t){return t.match(/(\d+(px|in|mm|cm|pt)?)\s(\S+)\s(\S+)/)},processBorders=function(t,e){var r=matchBorderShorthand(e);if(r){if(t.match(/.Color/))return r[4];if(t.match(/.Style/))return r[3];if(t.match(/.Width/))return r[1];throw new Error("StyleSheet: Invalid '"+e+"' for '"+t+"'")}return e},transformStyles=function(t){for(var e=expandStyles(t),r=_Object$keys(e),n={},i=0;i<r.length;i++){var o=r[i],a=e[o],s=o.match(/border/)&&"string"==typeof a?processBorders(o,a):a;n[o]=parseScalar(s)}return n},create=function(t){return t},flatten=function(t){return Array.isArray(t)||(t=[t]),t.reduce(function(t,e){return e&&_Object$keys(e).forEach(function(r){null!==e[r]&&void 0!==e[r]&&(t[r]=e[r])}),t},{})},resolveMediaQueries=function(t,e){return _Object$keys(t).reduce(function(r,n){var i,o;return/@media/.test(n)?_extends({},r,matchMedia(((o={})[n]=t[n],o),e)):_extends({},r,((i={})[n]=t[n],i))},{})},resolve=function(t,e){return t?(t=flatten(t),t=resolveMediaQueries(t,e),t=transformStyles(t)):null},absoluteFillObject={position:"absolute",top:0,left:0,bottom:0,right:0},StyleSheet={hairlineWidth:1,create:create,resolve:resolve,flatten:flatten,absoluteFillObject:absoluteFillObject},Debug={debug:function(){var t=this.getAbsoluteLayout(),e=this.padding,r=this.margin;this.root.instance.save(),this.debugContent(t,r,e),this.debugPadding(t,r,e),this.debugMargin(t,r),this.debugText(t,r),this.root.instance.restore()},debugText:function(t,e){var r=Math.round(this.width+e.left+e.right),n=Math.round(this.height+e.top+e.bottom);this.root.instance.fontSize(4).opacity(1).fillColor("black").text(r+" x "+n,t.left-e.left,Math.max(t.top-e.top-4,1))},debugContent:function(t,e,r){this.root.instance.fillColor("#a1c6e7").opacity(.5).rect(t.left+r.left,t.top+r.top,t.width-r.left-r.right,t.height-r.top-r.bottom).fill()},debugPadding:function(t,e,r){this.root.instance.fillColor("#c4deb9").opacity(.5),this.root.instance.rect(t.left+r.left,t.top,t.width-r.right-r.left,r.top).fill(),this.root.instance.rect(t.left,t.top,r.left,t.height).fill(),this.root.instance.rect(t.left+t.width-r.right,t.top,r.right,t.height).fill(),this.root.instance.rect(t.left+r.left,t.top+t.height-r.bottom,t.width-r.right-r.left,r.bottom).fill()},debugMargin:function(t,e){this.root.instance.fillColor("#f8cca1").opacity(.5),this.root.instance.rect(t.left,t.top-e.top,t.width,e.top).fill(),this.root.instance.rect(t.left-e.left,t.top-e.top,e.left,t.height+e.top+e.bottom).fill(),this.root.instance.rect(t.left+t.width,t.top-e.top,e.right,t.height+e.top+e.bottom).fill(),this.root.instance.rect(t.left,t.top+t.height,t.width,e.bottom).fill()}},Borders={drawBorders:function(){var t=this.getAbsoluteLayout(),e=t.left,r=t.top,n=t.width,i=t.height,o=this.borderTopWidth,a=void 0===o?0:o,s=this.borderRightWidth,u=void 0===s?0:s,h=this.borderBottomWidth,l=void 0===h?0:h,c=this.borderLeftWidth,p=void 0===c?0:c,d=this.getComputedStyles(),f=d.borderTopLeftRadius,g=void 0===f?0:f,m=d.borderTopRightRadius,y=void 0===m?0:m,b=d.borderBottomRightRadius,v=void 0===b?0:b,E=d.borderBottomLeftRadius,_=void 0===E?0:E,R=d.borderTopColor,C=void 0===R?"black":R,T=d.borderRightColor,k=void 0===T?"black":T,w=d.borderBottomColor,S=void 0===w?"black":w,x=d.borderLeftColor,L=void 0===x?"black":x,P=d.borderTopStyle,I=void 0===P?"solid":P,D=d.borderRightStyle,A=void 0===D?"solid":D,B=d.borderBottomStyle,O=void 0===B?"solid":B,F=d.borderLeftStyle,N=void 0===F?"solid":F;this.root.instance.save(),this.drawHorizontalBorder([e+(g>0?a/2:0),r+a/2],[e+n-(y>0?a/2:0),r+a/2],g,y,a,C,I),this.drawVerticalBorder([e+n-u/2,r+(y>0?u/2:0)],[e+n-u/2,r+i-(v>0?u/2:0)],-y,-v,u,k,A),this.drawHorizontalBorder([e+n-(v>0?l/2:0),r+i-l/2],[e+(_>0?l/2:0),r+i-l/2],-v,-_,l,S,O),this.drawVerticalBorder([e+p/2,r+i-(_>0?p/2:0)],[e+p/2,r+(g>0?p/2:0)],_,g,p,L,N),this.root.instance.restore()},traceBorder:function(t,e){switch(t){case"dashed":this.root.instance.dash(2*e,{space:1.2*e}).stroke();break;case"dotted":this.root.instance.dash(e,{space:1.2*e}).stroke();break;default:this.root.instance.stroke()}},drawHorizontalBorder:function(t,e,r,n,i,o,a){i<=0||(this.root.instance.lineWidth(i).moveTo(t[0],t[1]+r).quadraticCurveTo(t[0],t[1],t[0]+r,t[1]).lineTo(e[0]-n,e[1]).quadraticCurveTo(e[0],e[1],e[0],e[1]+n).strokeColor(o),this.traceBorder(a,i))},drawVerticalBorder:function(t,e,r,n,i,o,a){i<=0||(this.root.instance.lineWidth(i).moveTo(t[0]+r,t[1]).quadraticCurveTo(t[0],t[1],t[0],t[1]-r).lineTo(e[0],e[1]+n).quadraticCurveTo(e[0],e[1],e[0]+n,e[1]).strokeColor(o),this.traceBorder(a,i))}},getRotation=function(t){var e=/rotate\((-?\d+.?\d+)(.+)\)/g.exec(t);if(e&&e[1]&&e[2]){var r=e[1];return"rad"===e[2]?180*r/Math.PI:r}return 0},getTranslateX=function(t){var e=/translateX\((-?\d+\.?d*)\)/g.exec(t),r=/translate\((-?\d+\.?d*).*,\s*(-?\d+\.?d*).*\)/g.exec(t);return e&&e[1]?e[1]:r&&r[1]?r[1]:0},getTranslateY=function(t){var e=/translateY\((-?\d+\.?\d*)\)/g.exec(t),r=/translate\((-?\d+\.?\d*).*,\s*(-?\d+\.?\d*).*\)/g.exec(t);return e&&e[1]?e[1]:r&&r[2]?r[2]:0},getScaleX=function(t){var e=/scaleX\((-?\d+\.?\d*)\)/g.exec(t),r=/scale\((-?\d+\.?\d*).*,\s*(-?\d+\.?\d*).*\)/g.exec(t);return e&&e[1]?e[1]:r&&r[1]?r[1]:1},getScaleY=function(t){var e=/scaleY\((-?\d+\.?\d*)\)/g.exec(t),r=/scale\((-?\d+\.?\d*).*,\s*(-?\d+\.?\d*).*\)/g.exec(t);return e&&e[1]?e[1]:r&&r[2]?r[2]:1},getMatrix=function(t){var e=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/g.exec(t);return e?e.slice(1,7):null},applySingleTransformation=function(t,e){var r=t.getAbsoluteLayout(),n=r.left,i=r.top,o=[n+r.width/2,i+r.height/2];if(/rotate/g.test(e))t.root.instance.rotate(getRotation(e),{origin:o});else if(/scaleX/g.test(e))t.root.instance.scale(getScaleX(e),1,{origin:o});else if(/scaleY/g.test(e))t.root.instance.scale(1,getScaleY(e),{origin:o});else if(/scale/g.test(e))t.root.instance.scale(getScaleX(e),getScaleY(e),{origin:o});else if(/translateX/g.test(e))t.root.instance.translate(getTranslateX(e),1,{origin:o});else if(/translateY/g.test(e))t.root.instance.translate(1,getTranslateY(e),{origin:o});else if(/translate/g.test(e))t.root.instance.translate(getTranslateX(e),getTranslateY(e),{origin:o});else if(/matrix/g.test(e)){var a;(a=t.root.instance).transform.apply(a,getMatrix(e))}},Transformations={applyTransformations:function(){for(var t=void 0,e=/[a-zA-Z]+\([^)]+\)/g,r=this.style&&this.style.transform||"";null!=(t=e.exec(r));)applySingleTransformation(this,t[0])}},Base=function(t){function e(r,n){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this));return i.root=r,i.props=merge({},i.constructor.defaultProps,e.defaultProps,n),warning(!i.props.styles,'"styles" prop passed instead of "style" prop'),i}return _inherits(e,t),e.prototype.applyProps=function(){var t=this,e=this.page,r=e.size,n=e.orientation;this.style=StyleSheet.resolve(this.props.style,{width:r.width,height:r.height,orientation:n}),toPairsIn(this.style).map(function(e){var r=e[0],n=e[1];t.applyStyle(r,n)}),this.children.forEach(function(t){t.applyProps&&t.applyProps()})},e.prototype.applyStyle=function(t,e){var r="set"+upperFirst(t);switch(t){case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":case"borderTopWidth":case"borderRightWidth":case"borderBottomWidth":case"borderLeftWidth":case"position":case"top":case"right":case"bottom":case"left":case"width":case"height":case"minHeight":case"maxHeight":case"minWidth":case"maxWidth":this[t]=e;break;default:isFunction(this.layout[r])&&this.layout[r](e)}},e.prototype.getComputedStyles=function(){for(var t=this.parent,e={};t&&t.parent;)e=_extends({},t.parent.style,t.style,e),t=t.parent;return _extends({},pick(e,inheritedProperties),this.style)},e.prototype.drawBackgroundColor=function(){var t=this.getAbsoluteLayout(),e=t.left,r=t.top,n=t.width,i=t.height,o=this.getComputedStyles(),a=Math.max(o.borderTopLeftRadius,o.borderTopRightRadius,o.borderBottomRightRadius,o.borderBottomLeftRadius)||0;o.backgroundColor&&this.root.instance.fillColor(o.backgroundColor).roundedRect(e,r,n,i,a).fill()},e.prototype.clone=function(){var t=new this.constructor(this.root,this.props);return t.copyStyle(this),t.style=this.style,t},e.prototype.onNodeSplit=function(t,e){this.calculateLayout(),e.marginTop=0,e.paddingTop=0,e.style.height&&(e.height=this.height-t),this.height=t,this.marginBottom=0,this.paddingBottom=0},e.prototype.update=function(t){this.props=merge({},this.constructor.defaultProps,e.defaultProps,t),this.root.markDirty()},e.prototype.renderChildren=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n,i;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.children.filter(function(t){return t.absolute}),r=this.children.filter(function(t){return!t.absolute}),n=0;case 3:if(!(n<r.length)){t.next=9;break}return t.next=6,r[n].render();case 6:n++,t.next=3;break;case 9:i=0;case 10:if(!(i<e.length)){t.next=16;break}return t.next=13,e[i].render();case 13:i++,t.next=10;break;case 16:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"page",get:function(){return this.parent.page}},{key:"wrap",get:function(){return this.props.wrap}},{key:"break",get:function(){return this.props.break},set:function(t){this.props.break=t}},{key:"fixed",get:function(){return this.props.fixed}},{key:"minPresenceAhead",get:function(){return this.props.minPresenceAhead}},{key:"absolute",get:function(){return"absolute"===this.props.style.position}}]),e}(Node$1);Base.defaultProps={style:{borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:0,borderBottomLeftRadius:0},minPresenceAhead:0},_Object$assign(Base.prototype,Debug),_Object$assign(Base.prototype,Borders),_Object$assign(Base.prototype,Transformations);var TextInstance=function(){function t(e,r){_classCallCheck(this,t),this.root=e,this.value=r,this.parent=null,this.props={}}return t.prototype.remove=function(){this.parent.removeChild(this)},t.prototype.clone=function(){return new this.constructor(this.root,this.value)},t.prototype.update=function(t){this.value=t,this.parent.computed=!1,this.parent._container=null,this.root.markDirty()},_createClass(t,[{key:"name",get:function(){return"TextInstance"}}]),t}(),PAGE_SIZES={"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]},getPageSize=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"portrait",r=void 0;if("string"==typeof t)r=PAGE_SIZES[t.toUpperCase()];else if(Array.isArray(t))r=t;else{if("object"!==(void 0===t?"undefined":_typeof(t))||!t.width||!t.height)throw new Error("Invalid Page size: "+t);r=[t.width,t.height]}return"portrait"===e?{width:r[0],height:r[1]}:{width:r[1],height:r[0]}},RULER_WIDTH=13,RULER_COLOR="white",RULER_FONT_SIZE=5,DEFAULT_RULER_STEPS=50,LINE_WIDTH=.5,LINE_COLOR="gray",GRID_COLOR="#ababab",range=function(t,e){return _Array$from({length:Math.ceil(t/e)},function(t,r){return r*e})},matchPercentage=function(t){var e=t.match(/(\d+\.?\d*)%/);return e?100/parseFloat(e[1],10):null},Ruler={getRulerWidth:function(){return RULER_WIDTH},hasHorizontalRuler:function(){return this.props.ruler||this.props.horizontalRuler},hasVerticalRuler:function(){return this.props.ruler||this.props.verticalRuler},getHorizontalSteps:function(){var t=this.props.horizontalRulerSteps||this.props.rulerSteps||DEFAULT_RULER_STEPS;if("string"==typeof t){var e=matchPercentage(t);if(e)return(this.width-(this.hasVerticalRuler()?RULER_WIDTH:0))/e;throw new Error("Page: Invalid horizontal steps value")}return t},getVerticalSteps:function(){var t=this.props.verticalRulerSteps||this.props.rulerSteps||DEFAULT_RULER_STEPS;if("string"==typeof t){var e=matchPercentage(t);if(e)return(this.height-(this.hasHorizontalRuler()?RULER_WIDTH:0))/e;throw new Error("Page: Invalid horizontal steps value")}return t},renderRuler:function(){var t=this.hasHorizontalRuler(),e=this.hasVerticalRuler();(t||e)&&(this.root.instance.save().lineWidth(LINE_WIDTH).fontSize(RULER_FONT_SIZE).opacity(1),t&&this.drawHorizontalRuler(),e&&this.drawVerticalRuler(),t&&e&&this.root.instance.rect(0,0,RULER_WIDTH-LINE_WIDTH,RULER_WIDTH-LINE_WIDTH).fill(RULER_COLOR),this.root.instance.restore())},drawHorizontalRuler:function(){var t=this,e=this.hasVerticalRuler()?RULER_WIDTH:0;this.root.instance.rect(e,0,this.width,RULER_WIDTH).fill(RULER_COLOR).moveTo(this.hasVerticalRuler()?RULER_WIDTH:0,RULER_WIDTH).lineTo(this.width,RULER_WIDTH).stroke(LINE_COLOR);var r=range(this.width,this.getHorizontalSteps());r.map(function(r){t.root.instance.moveTo(e+r,0).lineTo(e+r,RULER_WIDTH).stroke(LINE_COLOR).fillColor("black").text(""+Math.round(r),e+r+1,1)}),r.map(function(r){0!==r&&t.root.instance.moveTo(e+r,RULER_WIDTH).lineTo(e+r,t.height).stroke(GRID_COLOR)})},drawVerticalRuler:function(){var t=this,e=this.hasHorizontalRuler()?RULER_WIDTH:0;this.root.instance.rect(0,e,RULER_WIDTH,this.height).fill(RULER_COLOR).moveTo(RULER_WIDTH,this.hasHorizontalRuler()?RULER_WIDTH:0).lineTo(RULER_WIDTH,this.height).stroke(LINE_COLOR);var r=range(this.height,this.getVerticalSteps());r.map(function(r){t.root.instance.moveTo(0,e+r).lineTo(RULER_WIDTH,e+r).stroke(LINE_COLOR).fillColor("black").text(""+Math.round(r),1,e+r+1)}),r.map(function(r){0!==r&&t.root.instance.moveTo(RULER_WIDTH,e+r).lineTo(t.width,e+r).stroke(GRID_COLOR)})}},Page$1=function(t){function e(r,n){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,r,n));return i._size=null,i}return _inherits(e,t),e.prototype.resetMargins=function(){(this.style.marginTop||this.style.marginBottom||this.style.marginLeft||this.style.marginRight)&&(warning(!1,"Margin values are not allowed on Page element. Use padding instead."),this.style.marginTop=0,this.style.marginBottom=0,this.style.marginLeft=0,this.style.marginRight=0)},e.prototype.applyProps=function(){this.top=0,this.left=0,this.style=StyleSheet.resolve(this.props.style),this.resetMargins(),this.layout.setWidth(this.size.width);var e=this.getRulerWidth(),r=this.style,n=r.paddingTop,i=void 0===n?0:n,o=r.paddingLeft,a=void 0===o?0:o;this.hasHorizontalRuler()&&(this.style.paddingTop=i+e),this.hasVerticalRuler()&&(this.style.paddingLeft=a+e),t.prototype.applyProps.call(this)},e.prototype.addDynamicChild=function(t,e){if(e)for(var r=Array.isArray(e)?e:[e],n=0;n<r.length;n++){var i=r[n],o=i.type,a=i.props;if("string"==typeof i){var s=new TextInstance(this.root,i);t.appendChild(s)}else if(o!==Fragment){var u=createInstance(i,this.root);t.appendChild(u),u.applyProps(),this.addDynamicChild(u,a.children)}else this.addDynamicChild(t,a.children)}},e.prototype.renderDynamicNodes=function(t,e){for(var r=this.children.slice(0);r.length>0;){var n=r.shift();if((!e||e(n))&&n.props.render){n.removeAllChilds();var i=n.props.render(t);this.addDynamicChild(n,i),n.fixed||(n.props.render=null)}else n.children&&r.push.apply(r,n.children)}},e.prototype.nodeWillWrap=function(t){this.renderDynamicNodes(t),this.calculateLayout()},e.prototype.onNodeSplit=function(t,e){e.marginTop=0,this.marginBottom=0,this.calculateLayout()},e.prototype.update=function(t){},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._size=this.size,e},e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.root.instance,this.height=this.size.height,this.calculateLayout(),e.addPage({size:[this.size.width,this.size.height],margin:0}),this.style.backgroundColor&&e.fillColor(this.style.backgroundColor).rect(0,0,this.size.width,this.size.height).fill(),t.next=7,this.renderChildren();case 7:this.props.debug&&this.debug(),this.renderRuler();case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"Page"}},{key:"document",get:function(){return this.parent}},{key:"page",get:function(){return this}},{key:"orientation",get:function(){return this.props.orientation}},{key:"size",get:function(){return this._size?this._size:(this._size=getPageSize(this.props.size,this.orientation),this.hasHorizontalRuler()&&(this._size.width+=this.getRulerWidth()),this.hasVerticalRuler()&&(this._size.height+=this.getRulerWidth()),this._size)}}]),e}(Base);Page$1.defaultProps={size:"A4",orientation:"portrait",style:{},wrap:!0},_Object$assign(Page$1.prototype,Ruler);var View$1=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.root.instance.save(),this.applyTransformations(),this.drawBackgroundColor(),this.drawBorders(),t.next=6,this.renderChildren();case 6:this.props.debug&&this.debug(),this.root.instance.restore();case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"View"}}]),e}(Base);View$1.defaultProps={style:{},wrap:!0};var PROTOCOL_REGEXP=/^(http|https|ftp|ftps|mailto)\:\/\//i,getURL=function(t){var e=t;return"string"!=typeof e||e.match(PROTOCOL_REGEXP)||(e="http://"+e),e},IGNORABLE_CODEPOINTS=[8232,8233],buildSubsetForFont=function(t){return IGNORABLE_CODEPOINTS.reduce(function(e,r){return t.hasGlyphForCodePoint&&t.hasGlyphForCodePoint(r)?e:[].concat(e,[String.fromCharCode(r)])},[])},ignoreChars=function(t){return t.map(function(t){var e=buildSubsetForFont(t.attributes.font),r=new RegExp(e.join("|"));return{string:t.string.replace(r,""),attributes:t.attributes}})},PREPROCESSORS=[ignoreChars,embedEmojis],transformText=function(t,e){switch(e){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"capitalize":return upperFirst(t);default:return t}},getFragments=function t(e){var r=[],n=e.getComputedStyles(),i=n.color,o=void 0===i?"black":i,a=n.fontFamily,s=void 0===a?"Helvetica":a,u=n.fontSize,h=void 0===u?18:u,l=n.textAlign,c=void 0===l?"left":l,p=n.position,d=n.top,f=n.bottom,g=n.lineHeight,m=n.textDecoration,y=n.textDecorationColor,b=n.textDecorationStyle,v=n.textTransform,E=n.letterSpacing;e.children.forEach(function(n){if(null!==n.value&&void 0!==n.value){var i=Font.getFont(s),a=i?i.data:s,u=transformText(n.value,v);r.push({string:u,attributes:{font:a,color:o,fontSize:h,align:c,link:e.src,characterSpacing:E,underlineStyle:b,underline:"underline"===m,underlineColor:y||o,lineHeight:g?g*h:null,yOffset:"relative"===p?-d||f||0:null}})}else{var l;if(n)(l=r).push.apply(l,t(n))}});var _=PREPROCESSORS,R=Array.isArray(_),C=0;for(_=R?_:_getIterator(_);;){var T;if(R){if(C>=_.length)break;T=_[C++]}else{if((C=_.next()).done)break;T=C.value}r=T(r)}return r},getAttributedString=function(t){return AttributedString.fromFragments(getFragments(t)).trim()},INFINITY=999999,PDFRenderer$2=createPDFRenderer({Rect:Rect}),Text$1=function(t){function e(r,n){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,r,n));return i.start=0,i.end=0,i.computed=!1,i._container=null,i._attributedString=null,i.renderCallback=n.render,i.layout.setMeasureFunc(i.measureText.bind(i)),i}return _inherits(e,t),e.prototype.appendChild=function(t){t&&(t.parent=this,this.children.push(t),this.computed=!1,this._attributedString=null,this.markDirty())},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!==e&&(t.parent=null,this.children.splice(e,1),this.computed=!1,this._attributedString=null,this.markDirty())},e.prototype.lineIndexAtHeight=function(t){for(var e=0,r=0;r<this.lines.length;r++){var n=this.lines[r];if(e+n.height>t)return r;e+=n.height}return this.lines.length},e.prototype.heightAtLineIndex=function(t){for(var e=0,r=0;r<t;r++){e+=this.lines[r].height}return e},e.prototype.layoutText=function(t,e){if(e=e||INFINITY,!this._container||this.props.render){var r=(new Path).rect(0,0,t,e),n=new Container(r),i=this.attributedString;this.root.layoutEngine.layout(i,[n]),this._container=n}var o=this._container.blocks.reduce(function(t,e){return t+e.lines.length},0);this.computed=!0,this.end=o+1},e.prototype.measureText=function(t,e,r,n){return e===Yoga.MEASURE_MODE_EXACTLY?(this.layoutText(t),{height:this.style.flexGrow?NaN:this.linesHeight}):e===Yoga.MEASURE_MODE_AT_MOST||n===Yoga.MEASURE_MODE_AT_MOST?(this.layoutText(t,r),{height:this.linesHeight,width:Math.min(t,this.linesWidth)}):{}},e.prototype.getComputedStyles=function(){var e=t.prototype.getComputedStyles.call(this);return this.parent&&"Text"===this.parent.name&&"relative"===this.parent.style.position&&(e.top=e.top||this.parent.style.top,e.bottom=e.bottom||this.parent.style.bottom,e.position=e.position||"relative"),this.src&&(e.color=e.color||"blue",e.textDecoration=e.textDecoration||"underline"),e},e.prototype.wrapHeight=function(t){var e=this.props,r=e.orphans,n=e.widows,i=this.lines.length,o=t-this.paddingTop,a=this.lineIndexAtHeight(o);return i<r?t:a<r||i<r+n?0:i===r+n?this.heightAtLineIndex(r-1):i-a<n?t-this.heightAtLineIndex(n-1):t},e.prototype.onNodeSplit=function(t,e){var r=this.wrapHeight(t),n=this.lineIndexAtHeight(r),i=this.lines[n-1];e.marginTop=0,e.paddingTop=0,e.start=n,e.attributedString=this.attributedString.slice(i?i.stringEnd:0,this.attributedString.length),this.height=r,this.marginBottom=0,this.paddingBottom=0,this.end=n},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return this.props.render||this.props.fixed||(e._container=this._container),e},e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n,i,o;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.root.instance.save(),this.applyTransformations(),this.drawBackgroundColor(),this.drawBorders(),this.computed||this.layoutText(this.width-this.padding.left-this.padding.right,this.height-this.padding.top-this.padding.bottom),e=this.padding,r=this.getAbsoluteLayout(),n=r.top,i=r.left,o=this.lines[0]?this.lines[0].rect.y:0,this.lines.forEach(function(t){t.rect.x+=i+e.left,t.rect.y+=n+e.top-o}),new PDFRenderer$2(this.root.instance,{outlineLines:!1}).render(this.container),this.props.debug&&this.debug(),this.root.instance.restore();case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"Text"}},{key:"src",get:function(){return getURL(this.props.src||this.props.href)}},{key:"attributedString",get:function(){return this._attributedString||(this._attributedString=getAttributedString(this)),this._attributedString},set:function(t){this._attributedString=t}},{key:"container",get:function(){var t=this._container.blocks.reduce(function(t,e){return[].concat(t,e.lines)},[]);return _extends({},this._container,{blocks:[{lines:t.splice(this.start,this.end)}]})}},{key:"lines",get:function(){return this.container?this.container.blocks.reduce(function(t,e){return[].concat(t,e.lines)},[]):[]}},{key:"linesHeight",get:function(){return this._container?this.lines.reduce(function(t,e){return t+e.height},0):-1}},{key:"linesWidth",get:function(){return this._container?Math.max.apply(Math,this.lines.map(function(t){return t.advanceWidth})):-1}}]),e}(Base);Text$1.defaultProps={wrap:!0,widows:2,orphans:2};var Link$1=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n,i,o;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.getAbsoluteLayout(),r=e.top,n=e.left,i=e.width,o=e.height,this.root.instance.link(n,r,i,o,this.src),t.next=4,this.renderChildren();case 4:this.props.debug&&this.debug();case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"Link"}},{key:"src",get:function(){return getURL(this.props.src||this.props.href)}}]),e}(Base),Note$1=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,t.apply(this,arguments))}return _inherits(e,t),e.prototype.appendChild=function(t){if("TextInstance"!==t.name)throw new Error("Note only accepts string children");t&&(t.parent=this,this.children.push(t))},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);-1!==e&&(t.parent=null,this.children.splice(e,1))},e.prototype.applyProps=function(){t.prototype.applyProps.call(this),this.height=0,this.width=0},e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n,i;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.getAbsoluteLayout(),r=e.top,n=e.left,i=this.children[0]?this.children[0].value:"",this.root.instance.note(n,r,0,0,i);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"Note"}}]),e}(Base);Note$1.defaultProps={};var SAFETY_HEIGHT=10,Image$1=function(t){function e(r,n){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,t.call(this,r,n));return i.image=null,i.layout.setMeasureFunc(i.measureImage.bind(i)),i}return _inherits(e,t),e.prototype.shouldGrow=function(){return!!this.getComputedStyles().flexGrow},e.prototype.measureImage=function(t,e,r,n){var i=this.margin,o=this.page.padding,a=this.page.size.height-o.top-o.bottom-i.top-i.bottom-SAFETY_HEIGHT;if(!this.image)return{width:0,height:0};if(e===Yoga.MEASURE_MODE_EXACTLY&&n===Yoga.MEASURE_MODE_UNDEFINED){var s=t/this.ratio;return{height:Math.min(a,s)}}if(n===Yoga.MEASURE_MODE_EXACTLY&&(e===Yoga.MEASURE_MODE_AT_MOST||e===Yoga.MEASURE_MODE_UNDEFINED))return{width:Math.min(r*this.ratio,t)};if(e===Yoga.MEASURE_MODE_EXACTLY&&n===Yoga.MEASURE_MODE_AT_MOST){var u=t/this.ratio;return{height:Math.min(r,a,u)}}if(e===Yoga.MEASURE_MODE_AT_MOST&&n===Yoga.MEASURE_MODE_AT_MOST){var h=Math.min(this.image.width,t);return{width:h,height:h/this.ratio}}return{height:r,width:t}},e.prototype.fetch=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,resolveImage(this.props.src,this.props.cache);case 3:this.image=t.sent,t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),this.image={width:0,height:0},console.warn(t.t0.message);case 10:case"end":return t.stop()}},t,this,[[0,6]])}));return function(){return t.apply(this,arguments)}}(),e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e.image=this.image,e},e.prototype.render=function(){var t=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e,r,n,i,o,a,s;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=this.padding,r=this.getAbsoluteLayout(),n=r.left,i=r.top,this.root.instance.save(),this.applyTransformations(),this.drawBackgroundColor(),this.drawBorders(),this.image.data&&(o=Math.min(this.height*this.ratio,this.width)-e.left-e.right,a=this.height-e.top-e.bottom,s=Math.max((this.width-o)/2,0),0!==o&&0!==a?this.root.instance.image(this.image.data,n+e.left+s,i+e.top,{width:o,height:a}):warning(!1,"Image with src '"+this.props.src+"' skipped due to invalid dimensions")),this.props.debug&&this.debug(),this.root.instance.restore();case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),_createClass(e,[{key:"name",get:function(){return"Image"}},{key:"ratio",get:function(){return this.image.data?this.image.width/this.image.height:1}}]),e}(Base);Image$1.defaultProps={wrap:!1,cache:!0};var constructors={ROOT:Root,PAGE:Page$1,TEXT:Text$1,LINK:Link$1,VIEW:View$1,NOTE:Note$1,IMAGE:Image$1,DOCUMENT:Document$2,TEXT_INSTANCE:TextInstance};function createInstance(t,e){var r=t.type,n=t.props,i=void 0===n?{}:n;if(constructors[r])return new constructors[r](e,i);throw new Error("Invalid element of type "+r+" passed to PDF renderer")}var objectsEqual=function t(e,r){var n=_Object$keys(e),i=_Object$keys(r);if(n.length!==i.length)return!1;for(var o=0;o<n.length;o++){var a=n[o];if("render"!==a){if("children"!==a&&e[a]!==r[a]){if("object"===_typeof(e[a])&&"object"===_typeof(r[a])&&t(e[a],r[a]))continue;return!1}}else if(!e[a]!=!r[a])return!1}return!0},shouldReplaceLink=function(t,e){return"LINK"===t&&("string"==typeof e.children||Array.isArray(e.children)||e.render)},PDFRenderer=ReactFiberReconciler({supportsMutation:!0,appendInitialChild:function(t,e){t.appendChild(e)},createInstance:function(t,e,r){return createInstance({type:shouldReplaceLink(t,e)?"TEXT":t,props:e},r)},createTextInstance:function(t,e){return createInstance({type:"TEXT_INSTANCE",props:t},e)},finalizeInitialChildren:function(t,e,r){return!1},getPublicInstance:function(t){return t},prepareForCommit:function(){},prepareUpdate:function(t,e,r,n){return!objectsEqual(r,n)},resetAfterCommit:function(){},resetTextContent:function(t){},getRootHostContext:function(){return emptyObject},getChildHostContext:function(){return emptyObject},shouldSetTextContent:function(t,e){return!1},now:Date.now,useSyncScheduling:!0,appendChild:function(t,e){t.appendChild(e)},appendChildToContainer:function(t,e){t.appendChild(e)},removeChild:function(t,e){t.removeChild(e)},removeChildFromContainer:function(t,e){t.removeChild(e)},commitTextUpdate:function(t,e,r){t.update(r)},commitUpdate:function(t,e,r,n,i){t.update(i)}}),version="1.0.0-alpha.24",View="VIEW",Text="TEXT",Link="LINK",Page="PAGE",Note="NOTE",Image="IMAGE",Document$1="DOCUMENT",pdf=function(t){var e,r=(e=_asyncToGenerator(_regeneratorRuntime.mark(function t(){var e;return _regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.render();case 2:return e=n.instance.pipe(BlobStream()),t.abrupt("return",new _Promise(function(t,r){e.on("finish",function(){try{var i=e.toBlob("application/pdf");n.document.props.onRender&&n.document.props.onRender({blob:i}),t(i)}catch(t){r(t)}}),e.on("error",r)}));case 4:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)}),n=createInstance({type:"ROOT"}),i=PDFRenderer.createContainer(n);function o(t){PDFRenderer.updateContainer(t,i,null)}return t&&o(t),{isDirty:function(){return n.isDirty},updateContainer:o,toBuffer:function(){return n.document.props.onRender&&n.document.props.onRender(),n.render(),n.instance},toBlob:r,toString:function(){var t="";return n.render(),new _Promise(function(e,r){try{n.instance.on("data",function(e){t+=e}),n.instance.on("end",function(){n.document.props.onRender&&n.document.props.onRender({string:t}),e(t)})}catch(t){r(t)}})}}},Document$$1=function(t){var e=t.children,r=_objectWithoutProperties(t,["children"]);return React.createElement(Document$1,r,e)},InternalBlobProvider=function(t){function e(r){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this,r));return n.state={blob:null,url:null,loading:!0,error:null},n.instance=pdf(),n}return _inherits(e,t),e.prototype.componentDidMount=function(){this.renderDocument(),this.onDocumentUpdate()},e.prototype.componentDidUpdate=function(){this.renderDocument(),this.instance.isDirty()&&this.onDocumentUpdate()},e.prototype.renderDocument=function(){this.instance.updateContainer(this.props.document)},e.prototype.onDocumentUpdate=function(){var t=this;this.instance.toBlob().then(function(e){t.setState({blob:e,url:URL.createObjectURL(e),loading:!1})}).catch(function(e){throw t.setState({error:e}),e})},e.prototype.render=function(){return this.props.children(this.state)},e}(React.PureComponent),BlobProvider=function(t){var e=t.document,r=t.children;return e?React.createElement(InternalBlobProvider,{document:e},r):(warning(!1,"You should pass a valid document to BlobProvider"),null)},PDFViewer=function(t){var e=t.className,r=t.style,n=t.children;return React.createElement(InternalBlobProvider,{document:n},function(t){var n=t.url;return React.createElement("iframe",{className:e,src:n,style:Array.isArray(r)?flatStyles(r):r})})},PDFDownloadLink=function(t){var e=t.document,r=t.className,n=t.style,i=t.children,o=t.fileName,a=void 0===o?"document.pdf":o;if(!e)return warning(!1,"You should pass a valid document to PDFDownloadLink"),null;return React.createElement(InternalBlobProvider,{document:e},function(t){return React.createElement("a",{className:r,download:a,href:t.url,onClick:(e=t.blob,function(){window.navigator.msSaveBlob&&window.navigator.msSaveBlob(e,a)}),style:Array.isArray(n)?flatStyles(n):n},"function"==typeof i?i(t):i);var e})},dom={pdf:pdf,View:View,Text:Text,Link:Link,Page:Page,Font:Font,Note:Note,Image:Image,version:version,Document:Document$$1,PDFViewer:PDFViewer,StyleSheet:StyleSheet,PDFRenderer:PDFRenderer,BlobProvider:BlobProvider,createInstance:createInstance,PDFDownloadLink:PDFDownloadLink};export{Document$$1 as Document,BlobProvider,PDFViewer,PDFDownloadLink,pdf,View,Text,Link,Page,Font,Note,Image,version,StyleSheet,PDFRenderer,createInstance};export default dom;
//# sourceMappingURL=react-pdf.browser.es.min.js.map
